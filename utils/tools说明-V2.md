## Tools说明-V2
以上代码提供了一些工具函数和类，主要用于深度学习训练过程中的学习率调整、早停机制、标准化、结果可视化和评估等功能。以下是每个部分的功能详细说明：

---

### **1. `adjust_learning_rate` 函数**
#### 功能：
- 用于根据设定的策略动态调整优化器的学习率。
- 支持三种学习率调整策略：
  1. **`type1`**：学习率按照指数递减，每个 epoch 下降到原来的 50%。
  2. **`type2`**：在特定 epoch 设置特定学习率的分段式调整。
  3. **`cosine`**：使用余弦衰减公式调整学习率，逐渐降低学习率。

#### 工作方式：
- 检查当前 epoch 是否在指定的调整策略中定义。
- 如果是，则更新优化器中每组参数的学习率。

---

### **2. `EarlyStopping` 类**
#### 功能：
- 实现早停机制，防止过拟合。
- 在验证损失不再改善时，提前停止训练。

#### 属性：
- **`patience`**：容忍验证损失未改善的最大 epoch 数。
- **`verbose`**：控制是否输出详细信息。
- **`delta`**：用于判断改善是否足够大的阈值。
- **`early_stop`**：表示是否满足早停条件。
- **`val_loss_min`**：记录最小的验证损失。

#### 工作方式：
1. **调用时**：
   - 记录当前的验证损失 `val_loss`。
   - 如果验证损失没有显著改善（相对于 `delta`），增加计数器 `counter`。
   - 如果计数器超过 `patience`，设置 `early_stop = True`。
   - 如果验证损失有显著改善，保存模型权重并重置计数器。
2. **保存模型**：
   - 使用 `torch.save` 将模型的状态字典保存为 `checkpoint.pth`。

---

### **3. `dotdict` 类**
#### 功能：
- 一个字典子类，允许通过点语法访问字典的键值对。
- 例如，`d['key']` 可以通过 `d.key` 的方式访问。

---

### **4. `StandardScaler` 类**
#### 功能：
- 用于标准化数据，即将数据转换为零均值和单位标准差。
- 支持数据的正向标准化和反向还原操作。

#### 方法：
1. **`transform`**：
   - 将输入数据标准化为 `(data - mean) / std`。
2. **`inverse_transform`**：
   - 将标准化数据还原为原始值 `(data * std) + mean`。

---

### **5. `visual` 函数**
#### 功能：
- 用于结果的可视化。
- 绘制真实值 `true` 和预测值 `preds` 的对比图，并保存为 PDF。

---

### **6. `adjustment` 函数**
#### 功能：
- 对预测值进行调整，使得在某些情况下预测值更加符合连续异常的模式。

#### 逻辑：
1. 遍历真实值 `gt` 和预测值 `pred`。
2. 如果检测到一个异常开始点（`gt[i] == 1` 且 `pred[i] == 1`），将前后连续的异常段（根据真实值）中的预测值设为 `1`。
3. 如果当前是正常状态（`gt[i] == 0`），重置异常状态。

---

### **7. `cal_accuracy` 函数**
#### 功能：
- 计算预测值与真实值之间的准确率。
- **公式**：准确率 = 预测值和真实值完全匹配的比例。

---

### **工具的实际应用场景**
这些工具通常被整合到一个深度学习训练框架中：
- **`adjust_learning_rate`**：动态调整学习率以加速收敛或防止训练过早收敛。
- **`EarlyStopping`**：通过监控验证损失提前停止训练以节省资源。
- **`StandardScaler`**：对数据进行标准化以适应模型训练。
- **`visual`**：在训练或测试后直观展示模型性能。
- **`adjustment`**：对检测模型的输出进行后处理。
- **`cal_accuracy`**：快速评估模型性能。

这些工具能够显著提升模型训练的效率和效果，是深度学习训练过程中常用的模块。
